{% extends "base.html" %}



{% block bo_dy %}
<form method="POST" action="/topic" enctype="multipart/form-data"> 
    <label for="Message">Write your message</label>
    <input name="Message" type="text">

    <input name="TopicId" type="hidden" value="">

    <input name="AuthToken" type="hidden" value="">

    <input class="btn btn-oval" type="submit" value="send" />
    

</form>

<script>
    // Clear text input field after form submission
    document.querySelector('form').addEventListener('submit', function(event) {
        event.preventDefault();

        const messageInput = document.querySelector('input[name="Message"]');
        const message = messageInput.value.trim(); // Remove leading and trailing whitespace
        if (message === '') {
            console.log('Message is empty. Please enter a message.');
            return; // Do not submit form if message is empty
        }

        const formData = new FormData();
        formData.append('Message', message);
        formData.append('TopicId', document.querySelector('input[name="TopicId"]').value);
        formData.append('AuthToken', document.querySelector('input[name="AuthToken"]').value);

        fetch('/message', {
            method: 'POST',
            body: formData
        })
        .then(response => {
            if(response.ok) {
                console.log('Message sent successfully');
                messageInput.value = ''; // Clear the input field after successful submission
            } else {
                console.error('Failed to send message');
            }
        })
        .catch(error => console.error('Error:', error));
    });
</script>

<div class="navigate">
	<span>{{name}}|{{description}}</span>
</div>


{{HtmlContext | safe}}

<hr>



{% endblock bo_dy %}